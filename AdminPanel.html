<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <style>
      .container { padding: 20px; }
      button {
        width: 100%;
        margin-bottom: 10px;
        padding: 10px;
        font-size: 14px;
      }
      .header {
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 15px;
        border-bottom: 1px solid #ccc;
        padding-bottom: 10px;
      }
      .zone {
        margin-top: 20px;
      }
      .zone h4 {
        font-size: 14px;
        color: #666;
        margin-bottom: 10px;
      }
      .red {
        background-color: #f44336;
        color: white;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</div>

      <div>
        <h4>–û—Å–Ω–æ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h4>
        <button class="action" onclick="runAction('setup')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</button>
        <button class="action" onclick="runAction('webhook')">üîÑ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ–±—Ö—É–∫–æ–º</button>
        <button class="action" onclick="runAction('toggleProtection')">üîí –°–Ω—è—Ç—å/–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞—â–∏—Ç—É –ª–∏—Å—Ç–æ–≤</button>
      </div>

      <div class="zone">
        <h4>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h4>
        <button class="action" onclick="runAction('setTelegramToken')">üîë –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω Telegram</button>
        <button class="action" onclick="runAction('setGeminiApiKey')">üîë –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–ª—é—á Gemini</button>
        <button class="action" onclick="runAction('toggleMode')">ü§ñ/üñêÔ∏è –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º (AI/–†—É—á–Ω–æ–π)</button>
      </div>

      <div class="zone">
        <h4>–û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞</h4>
        <button class="red" onclick="runAction('clear')">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ç–∞–±–ª–∏—Ü—É</button>
      </div>
    </div>

    <script>
      function runAction(actionName) {
        document.querySelectorAll('.action').forEach(b => b.disabled = true);
        google.script.run
          .withSuccessHandler(() => {
            // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å –ø–∞–Ω–µ–ª—å
            document.querySelectorAll('.action').forEach(b => b.disabled = false);
            google.script.host.close(); // –ó–∞–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
          })
          .withFailureHandler((error) => {
            alert('–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ' + error.message);
            document.querySelectorAll('.action').forEach(b => b.disabled = false);
          })
          .runAdminAction(actionName);
      }
    </script>
  </body>
</html>