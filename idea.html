<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartPit v2 - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–¥–µ–π</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --warning: #fca311;
            --danger: #e63946;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #8d99ae;
            --gray-light: #edf2f4;
            --border-radius: 12px;
            --shadow: 0 10px 30px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            color: var(--primary);
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            color: var(--gray);
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
        }

        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 30px;
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--gray-light);
        }

        .card-header i {
            font-size: 2rem;
            color: var(--primary);
        }

        .card-header h3 {
            font-size: 1.5rem;
            color: var(--dark);
        }

        .idea-item {
            background: var(--gray-light);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }

        .idea-item h4 {
            color: var(--primary);
            margin-bottom: 8px;
        }

        .idea-item p {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .task-form {
            background: var(--light);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-top: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--dark);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--gray-light);
            border-radius: 8px;
            font-size: 14px;
            transition: var(--transition);
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: var(--transition);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-success {
            background: linear-gradient(45deg, var(--success), #2F80ED);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(45deg, var(--warning), #F5576C);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .task-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .task-item {
            background: white;
            border: 1px solid var(--gray-light);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            transition: var(--transition);
        }

        .task-item:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .task-title {
            font-weight: 500;
            color: var(--dark);
        }

        .task-priority {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .priority-high {
            background: var(--danger);
            color: white;
        }

        .priority-medium {
            background: var(--warning);
            color: white;
        }

        .priority-low {
            background: var(--success);
            color: white;
        }

        .task-description {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .task-meta {
            display: flex;
            gap: 15px;
            font-size: 0.8rem;
            color: var(--gray);
        }

        .mermaid {
            background: white;
            padding: 20px;
            border-radius: var(--border-radius);
            margin: 20px 0;
            overflow: auto;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .comparison-table th, 
        .comparison-table td {
            border: 1px solid var(--gray-light);
            padding: 12px;
            text-align: left;
        }

        .comparison-table th {
            background-color: var(--primary);
            color: white;
        }

        .comparison-table tr:nth-child(even) {
            background-color: var(--light);
        }

        .advantage {
            background-color: #d5f5e3;
            border-left: 4px solid var(--success);
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .disadvantage {
            background-color: #fadbd8;
            border-left: 4px solid var(--danger);
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 4px;
        }

        pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            font-size: 14px;
        }

        code {
            font-family: 'Courier New', Courier, monospace;
        }

        @media (max-width: 768px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-lightbulb"></i> SmartPit v2</h1>
            <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–¥–µ–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–º</p>
        </div>

        <div class="content-grid">
            <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Å –∏–¥–µ—è–º–∏ -->
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-lightbulb"></i>
                    <h3>–û—Å–Ω–æ–≤–Ω—ã–µ –∏–¥–µ–∏ –ø—Ä–æ–µ–∫—Ç–∞</h3>
                </div>
                
                <div class="idea-item">
                    <h4>üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞</h4>
                    <p>–°–æ–∑–¥–∞—Ç—å —É–º–Ω–æ–≥–æ, –Ω–∞–¥—ë–∂–Ω–æ–≥–æ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–≥–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –¥–ª—è –ø–∏—Ç–∞–Ω–∏—è –∏ –ª–∏—á–Ω—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ —á–µ—Ä–µ–∑ Telegram –∏ Google –¢–∞–±–ª–∏—Ü—ã.</p>
                </div>

                <div class="idea-item">
                    <h4>üîë –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–∞—è –∏–¥–µ–æ–ª–æ–≥–∏—è</h4>
                    <ul>
                        <li>–ü–æ–º–æ–≥–∞–µ—Ç –≤ –ø–∏—Ç–∞–Ω–∏–∏ –∏ –±—é–¥–∂–µ—Ç–µ ‚Äî –æ–±–ª–µ–≥—á–∞–µ—Ç —Ä—É—Ç–∏–Ω—É</li>
                        <li>–î–∞–Ω–Ω—ã–µ –≤ Google –¢–∞–±–ª–∏—Ü–µ ‚Äî –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å, –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è, –∫–æ–Ω—Ç—Ä–æ–ª—å</li>
                        <li>AI ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ‚Äî –Ω–µ –¥–ª—è —Ä—É—Ç–∏–Ω—ã</li>
                        <li>–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å ‚Äî Telegram-–±–æ—Ç ‚Äî —Å –∫–Ω–æ–ø–∫–∞–º–∏, –º–µ–Ω—é, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏</li>
                        <li>–ú–∏–Ω–∏–º—É–º —Å–ª–æ–∂–Ω–æ—Å—Ç–µ–π ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –¥–æ–ª–∂–µ–Ω –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã</li>
                    </ul>
                </div>

                <div class="idea-item">
                    <h4>üîÑ –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ</h4>
                    <table class="comparison-table">
                        <tr>
                            <th>–ë—ã–ª–æ</th>
                            <th>–°—Ç–∞–ª–æ</th>
                        </tr>
                        <tr>
                            <td>–õ–∏–Ω–µ–π–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞</td>
                            <td>–ú–æ–¥—É–ª—å–Ω–∞—è, —Å–æ–±—ã—Ç–∏–π–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è</td>
                        </tr>
                        <tr>
                            <td>–ù–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º</td>
                            <td>–î–æ–±–∞–≤–ª–µ–Ω state.js –¥–ª—è —Å–µ—Å—Å–∏–π</td>
                        </tr>
                        <tr>
                            <td>–ñ—ë—Å—Ç–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ AI</td>
                            <td>–ì–∏–±–∫–∏–π ai/adapter.js</td>
                        </tr>
                        <tr>
                            <td>–†—É—á–Ω–æ–π CRUD</td>
                            <td>–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π sheets/crud.js</td>
                        </tr>
                        <tr>
                            <td>–°–ª–æ–∂–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ</td>
                            <td>–ü—Ä–æ—Å—Ç–æ–µ: –¥–æ–±–∞–≤—å –º–æ–¥—É–ª—å ‚Äî –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç</td>
                        </tr>
                    </table>
                </div>
            </div>

            <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ -->
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-tasks"></i>
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏</h3>
                </div>

                <div class="task-form">
                    <h4>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É</h4>
                    <form id="taskForm">
                        <div class="form-group">
                            <label for="taskTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</label>
                            <input type="text" id="taskTitle" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="taskDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                            <textarea id="taskDescription" rows="3" placeholder="–û–ø–∏—à–∏—Ç–µ –∑–∞–¥–∞—á—É –ø–æ–¥—Ä–æ–±–Ω–æ"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="taskPriority">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                            <select id="taskPriority">
                                <option value="–ù–∏–∑–∫–∏–π">–ù–∏–∑–∫–∏–π</option>
                                <option value="–°—Ä–µ–¥–Ω–∏–π" selected>–°—Ä–µ–¥–Ω–∏–π</option>
                                <option value="–í—ã—Å–æ–∫–∏–π">–í—ã—Å–æ–∫–∏–π</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="taskAssignee">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</label>
                            <input type="text" id="taskAssignee" placeholder="–ö—Ç–æ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞—á—É">
                        </div>
                        
                        <div class="form-group">
                            <label for="taskDeadline">–î–µ–¥–ª–∞–π–Ω</label>
                            <input type="date" id="taskDeadline">
                        </div>
                        
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É
                        </button>
                    </form>
                </div>

                <div class="task-list" id="taskList">
                    <!-- –ó–∞–¥–∞—á–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π -->
        <div class="card">
            <div class="card-header">
                <i class="fas fa-sitemap"></i>
                <h3>–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞</h3>
            </div>
            
            <pre><code>SmartPit/
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ router.js            # –ï–¥–∏–Ω—ã–π —Ä–æ—É—Ç–µ—Ä –∫–æ–º–∞–Ω–¥ –∏ —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ state.js             # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îî‚îÄ‚îÄ logger.js            # –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ telegram/            # –†–∞–±–æ—Ç–∞ —Å Telegram
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.js           # –û—Ç–ø—Ä–∞–≤–∫–∞/–ø—Ä–∏—ë–º
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ keyboard.js      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ sheets/              # –†–∞–±–æ—Ç–∞ —Å Google Sheets
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ crud.js          # –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π CRUD
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schema.js        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ ai/                  # –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ò–ò
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prompt.js        # –ì–æ—Ç–æ–≤—ã–µ –ø—Ä–æ–º–ø—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ adapter.js       # –û–±—ë—Ä—Ç–∫–∞ –¥–ª—è Gemini/OpenRouter
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ offline/             # –û—Ñ–ª–∞–π–Ω-–∫–æ–º–∞–Ω–¥—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ menu.js          # /get_menu
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ purchases.js     # /show_purchases
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ budget.js        # /my_budget
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ online/              # –û–Ω–ª–∞–π–Ω-–∫–æ–º–∞–Ω–¥—ã
‚îÇ       ‚îú‚îÄ‚îÄ generate_menu.js # /create_new_menu
‚îÇ       ‚îî‚îÄ‚îÄ ask_ai.js        # /ask_ai
‚îÇ
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ markdown.js          # –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ MarkdownV2
‚îÇ   ‚îî‚îÄ‚îÄ helpers.js           # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ main.js                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (doPost)
‚îú‚îÄ‚îÄ config.js                # –ù–∞—Å—Ç—Ä–æ–π–∫–∏
‚îî‚îÄ‚îÄ PROJECT_PLAN.md          # –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª—è–µ–º—ã–π –ø–ª–∞–Ω</code></pre>
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Å –¥–∏–∞–≥—Ä–∞–º–º–æ–π -->
        <div class="card">
            <div class="card-header">
                <i class="fas fa-project-diagram"></i>
                <h3>–°—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–æ–¥—É–ª–µ–π</h3>
            </div>
            
            <div class="mermaid">
                graph TD
                    A[Telegram] -->|1. –°–æ–æ–±—â–µ–Ω–∏–µ| B[main.js]
                    B -->|2. –ü–∞—Ä—Å–∏–Ω–≥| C[core/router.js]
                    C -->|3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞| D{message / callback?}
                    
                    D -->|message| E{–ö–æ–º–∞–Ω–¥–∞?}
                    D -->|callback_query| F[core/state.js ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞]

                    E -->|/start, /menu| G[modules/offline/menu.js]
                    E -->|/create_new_menu| H[modules/online/generate_menu.js]
                    E -->|/ask_ai| I[modules/online/ask_ai.js]

                    G -->|–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö| J[modules/sheets/crud.js]
                    H -->|–ì–µ–Ω–µ—Ä–∞—Ü–∏—è| K[modules/ai/adapter.js]
                    I -->|–ó–∞–ø—Ä–æ—Å –∫ AI| K

                    J -->|Google Sheets| L[(–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)]
                    K -->|Gemini/OpenRouter| M[AI API]

                    F -->|–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è| N[core/state.js]
                    N -->|–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ| L
            </div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Mermaid
        mermaid.initialize({ startOnLoad: true });

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            loadTasks();
        };

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
        document.getElementById('taskForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const taskData = {
                name: document.getElementById('taskTitle').value,
                description: document.getElementById('taskDescription').value,
                priority: document.getElementById('taskPriority').value,
                assignee: document.getElementById('taskAssignee').value,
                deadline: document.getElementById('taskDeadline').value
            };
            
            addTask(taskData);
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('taskForm').reset();
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
        function addTask(taskData) {
            google.script.run
                .withSuccessHandler(function(result) {
                    if (result.success) {
                        showMessage('‚úÖ –ó–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');
                        loadTasks(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
                    } else {
                        showMessage('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏: ' + result.error);
                    }
                })
                .withFailureHandler(function(error) {
                    showMessage('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
                })
                .addNewTask(taskData);
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á
        function loadTasks() {
            google.script.run
                .withSuccessHandler(function(data) {
                    displayTasks(data.tasks || []);
                })
                .withFailureHandler(function(error) {
                    showMessage('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á: ' + error.message);
                })
                .getProjectData();
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–¥–∞—á
        function displayTasks(tasks) {
            const taskList = document.getElementById('taskList');
            
            if (tasks.length === 0) {
                taskList.innerHTML = '<p style="text-align: center; color: var(--gray);">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á</p>';
                return;
            }
            
            let html = '';
            tasks.forEach(task => {
                const priorityClass = task.priority === '–í—ã—Å–æ–∫–∏–π' ? 'priority-high' : 
                                    task.priority === '–°—Ä–µ–¥–Ω–∏–π' ? 'priority-medium' : 'priority-low';
                
                html += `
                    <div class="task-item">
                        <div class="task-header">
                            <div class="task-title">${task.name}</div>
                            <span class="task-priority ${priorityClass}">${task.priority}</span>
                        </div>
                        <div class="task-description">${task.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</div>
                        <div class="task-meta">
                            <span><i class="fas fa-user"></i> ${task.assignee || '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω'}</span>
                            <span><i class="fas fa-calendar"></i> ${task.deadline || '–î–µ–¥–ª–∞–π–Ω –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}</span>
                            <span><i class="fas fa-chart-line"></i> –ü—Ä–æ–≥—Ä–µ—Å—Å: ${task.progress || 0}%</span>
                        </div>
                    </div>
                `;
            });
            
            taskList.innerHTML = html;
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
        function showMessage(message) {
            // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 1000;
                font-weight: 500;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // –£–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    </script>
</body>
</html>