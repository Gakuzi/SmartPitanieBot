# Концепция Telegram-бота "Умная система питания"

## Ⅰ. Основная идея

Создание многофункционального Telegram-бота, который выступает в роли персонального нейро-диетолога, закупщика и организатора питания и шеф-повара. Система должна быть автономной и умной, помогая пользователю достигать своих целей в питании с учетом его индивидуальных параметров.

Главная функция бота — привязка всех расчётов и предложений к текущей геолокации пользователя. Пользователь по запросу отправляет свою геолокацию, указывает её текстом или выбирает точку на карте. Вся логика работы нейросети, включая подбор продуктов, рецептов, магазинов и анализ доступности, строится на основе этой точки.

## Ⅱ. Ключевые функции

1.  **Персонализация:**
    *   Знает цели пользователя (похудение, набор массы, удержание веса).
    *   Учитывает бюджет и фактическую геолокацию (по координатам или адресу) для подбора продуктов, магазинов и рецептов.
    *   Учитывает пищевые предпочтения (вегетарианец, безлактозное, безглютеновое и др.).
2.  **Планирование:**
    *   Подбирает меню и рецепты.
    *   Формирует списки закупок.
    *   Формирует списки закупок, привязанные к конкретным магазинам с учётом их ассортимента, наличия и цен.
    *   Планирует хранение продуктов.
3.  **Интерактивность:**
    *   Предлагает замены продуктам в магазине в реальном времени.
    *   Отслеживает сроки годности.
    *   Автоматически считает калории, БЖУ, стоимость и объемы.
4.  **Уведомления:**
    *   Напоминает о времени готовки.
    *   Предупреждает о продуктах с истекающим сроком годности.
    *   Информирует о необходимости совершить покупки.

## Ⅲ. Архитектура модулей

### 1. Модуль целей и параметров пользователя (`/start`)
*   **Сбор данных:**
    *   Цель (похудение / набор / удержание).
    *   Физические параметры (вес, рост, возраст, пол).
    *   Уровень активности.
    *   Бюджет на питание.
    *   Геолокация.
    *   Пищевые предпочтения и ограничения (например, без рыбы, грибов).
    *   График готовки (например, раз в 3 дня).
*   **Результат:** Создание индивидуального плана питания.

### 2. Нейросеть / Алгоритм питания
*   **Расчеты:**
    *   Определение суточной калорийности (формула Миффлина-Сан Жеора).
    *   Расчет баланса белков, жиров и углеводов (БЖУ).
*   **Генерация меню:**
    *   Подбор меню на основе шаблонов.
    *   Адаптация меню под бюджет, доступные в регионе магазины и пищевые ограничения.
    *   Использование LLM (например, GPT) для генерации индивидуальных рационов, основанных на предпочтениях, истории питания, целях и бюджете пользователя.
    *   Анализ потребностей на неделю вперёд и генерация сбалансированного меню с учётом сезонности и доступности продуктов в регионе.
    *   Автоматическое формирование плана закупок по сгенерированному меню с приоритизацией товаров по сроку годности и частоте использования.
    *   Формирует списки закупок, оптимизированные под конкретные магазины, с учётом их ассортимента, цен и наличия.
    *   Интеграция с внешними источниками (например, открытые рецептурные базы или API маркетплейсов) для расширения ассортимента.
*   **Хранение данных:** Запись сгенерированного плана в базу данных (Google Таблицы).
*   Возможность анализа истории питания для улучшения рекомендаций.

### 3. Модуль закупок (`/купить`)
*   **Функционал:**
    *   Отображение списка покупок на день.
    *   Обработка отсутствующих товаров (`/нет [название]`) и предложение аналогов.
    *   Учет уже имеющихся продуктов.
    *   Формирует списки закупок отдельно для каждого магазина, учитывая ассортимент, наличие и цены товаров в конкретном магазине.
    *   Ведение истории покупок по чекам (при подключении стороннего API или сканирования).

### 4. Модуль учета продуктов и сроков годности ("Холодильник")
*   **Функционал:**
    *   Добавление купленных продуктов в виртуальный "холодильник".
    *   Отслеживание количества и сроков годности.
    *   Ежедневные отчеты о состоянии запасов.
    *   Интеграция с модулем напоминаний: уведомления об окончании срока хранения.
    *   Получение информации о сроках годности через систему "Честный знак" при сканировании QR/штрих-кодов.

### 5. Модуль готовки (`/готовим`)
*   **Функционал:**
    *   Отображение плана готовки на сегодня (что и на сколько дней).
    *   Предоставление полных рецептов с интерактивными кнопками.
    *   Возможность отложить готовку, если еды достаточно.
    *   Отображение визуальной карточки рецепта с пошаговой навигацией.
    *   Интерактивные кнопки "Далее" и "Назад" внутри Telegram для перехода между шагами рецепта.
    *   Рецепты должны быть пошаговыми, и если этап требует ожидания (например, выпекание, тушение), пользователь может установить таймер.
    *   Таймер выполняет функцию напоминания: когда время истекает, бот уведомляет пользователя, что пора проверить блюдо.
    *   Только после ручного подтверждения ("далее") запускается следующий шаг — автоматическое переключение запрещено.

### 6. Модуль уведомлений
*   **Функционал:**
    *   Настраиваемые автоматические напоминания (утро, обед, вечер).
    *   Информирование о ключевых событиях: что готовить, что купить, что заканчивается.

### 7. Модуль аналитики и контроля
*   **Функционал:**
    *   Отображение статистики по калориям и БЖУ.
    *   Контроль бюджета и трат.
    *   Отчеты о купленных и использованных продуктах.
    *   Вывод рекомендаций по оптимизации трат и замене продуктов на более выгодные аналоги.

## Ⅳ. Этапы реализации

1.  **MVP (Минимально жизнеспособный продукт):**
    *   **Функции:** Меню, список покупок, рецепты, базовые напоминания, команды `/купить`, `/готовим`, `/меню`, `/осталось`.
    *   **Срок:** ~5–7 дней.
2.  **Pro (Интерактивная версия):**
    *   **Функции:** Замены продуктов, геолокация, учет остатков и сроков годности, контроль бюджета.
    *   **Срок:** ~2–3 недели.
3.  **AI-версия (Полноценная система):**
    *   **Функции:** Адаптивный подбор плана нейросетью, учет инфляции, анализ цен по чекам.
    *   **Срок:** ~1–2 месяца.

## V. Стартовые требования для MVP

1.  **Имя бота:** (например, `@SmartPitanieBot`)
2.  **Токен:** Получить от @BotFather.
3.  **Хранилище данных:** Google Таблицы (требуется настройка через Apps Script).
4.  **Вариативность планов:** Определить, будет ли бот предлагать разные типы планов (бюджетный, быстрый, на массу).
5.  **Модель пользователя:** Описание структуры профиля, где хранятся параметры, история и предпочтения.
